<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CubeSat Atitude Determination: Filters</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CubeSat Atitude Determination
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group___filters_gr.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">Filters</div>  </div>
</div><!--header-->
<div class="contents">

<p>A library for filtering attitude quaternion and other signals.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_filters_1_1_kalman_filter.html">Filters::KalmanFilter</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class implements a 7-state (quaternion and angular rates) Extended Kalman Filter for spacecraft atitude filtering.  <a href="class_filters_1_1_kalman_filter.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>A library for filtering attitude quaternion and other signals. </p>
<dl class="section version"><dt>Version</dt><dd>1.0 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2019 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Remy CHATEL </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>GNU Public License v3.0</dd></dl>
<h1>Description</h1>
<p>A set of algorithm to filter the attitude quaternion of a spacecraft. It implements a 7 state (quaternion and angular rates) Extended Kalman Filter.</p>
<p>It can be use to filter out noise in space applications for instance in Atitude Determination and Control Systems.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="class_filters_1_1_kalman_filter.html" title="This class implements a 7-state (quaternion and angular rates) Extended Kalman Filter for spacecraft ...">Filters::KalmanFilter</a></dd></dl>
<h1>Example code without atitude control</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_filters_8h.html">Filters.h</a>&quot;</span></div><div class="line"><span class="comment">// Set ups where taken from</span></div><div class="line"><span class="comment">// &quot;Kalman Filtering and the Attitude Determination and Control Task&quot;</span></div><div class="line"><span class="comment">// by Hale, Vergez, Meerman and Hashida</span></div><div class="line"></div><div class="line"><span class="comment">// Inputs</span></div><div class="line"><a class="code" href="class_matrix.html">Matrix</a> q = <a class="code" href="class_matrix.html#aa7bf588d788d601548a34030e59152b4">Matrix::zeros</a>(4,1);       <span class="comment">// The output quaternion</span></div><div class="line"><a class="code" href="class_matrix.html">Matrix</a> gyr_b = <a class="code" href="class_matrix.html#aa7bf588d788d601548a34030e59152b4">Matrix::zeros</a>(3,1);   <span class="comment">// The measured angular rates (in rad/s)</span></div><div class="line"><span class="keywordtype">float</span> dt = 0.010;                    <span class="comment">// The integration step</span></div><div class="line"><span class="keywordtype">float</span> sigma_gyr = 0.5;               <span class="comment">// The gyroscope variance</span></div><div class="line"><span class="keywordtype">float</span> sigma_eta = 0.1;               <span class="comment">// The quaternion scalar part variance</span></div><div class="line"><span class="keywordtype">float</span> sigma_epsilon = 0.1;           <span class="comment">// The quaternion vector part variance</span></div><div class="line"><a class="code" href="class_matrix.html">Matrix</a> q_init = <a class="code" href="class_matrix.html#aa7bf588d788d601548a34030e59152b4">Matrix::zeros</a>(4,1)   <span class="comment">// The initial quaterion</span></div><div class="line"><a class="code" href="class_matrix.html">Matrix</a> I_sat(3,3);                   <span class="comment">// Satellite inertia matrix</span></div><div class="line">I_sat &lt;&lt; 27 &lt;&lt;  0 &lt;&lt;  0</div><div class="line">      &lt;&lt;  0 &lt;&lt; 17 &lt;&lt;  0</div><div class="line">      &lt;&lt;  0 &lt;&lt;  0 &lt;&lt; 25;</div><div class="line"></div><div class="line"><span class="comment">// Set up</span></div><div class="line"><a class="code" href="class_matrix.html">Matrix</a> P_init   = <a class="code" href="class_matrix.html">Matrix</a>::eye(7);</div><div class="line"><a class="code" href="class_matrix.html">Matrix</a> Kalman_Q = <a class="code" href="class_matrix.html">Matrix</a>::eye(7);</div><div class="line"><a class="code" href="class_matrix.html">Matrix</a> Kalman_R = <a class="code" href="class_matrix.html">Matrix</a>::eye(7);</div><div class="line"><a class="code" href="class_matrix.html">Matrix</a> q_init   = <a class="code" href="class_matrix.html">Matrix</a>::zeros(4,1);</div><div class="line"></div><div class="line"><span class="comment">// Initial Covariance matrix set up</span></div><div class="line">P_init *= 0.01;</div><div class="line">P_init(5,5) = (sigma_gyr*<a class="code" href="_a_d_s_core_8h.html#af7e8592d0a634bd3642e9fd508ea8022">DEG2RAD</a>) * (sigma_gyr*<a class="code" href="_a_d_s_core_8h.html#af7e8592d0a634bd3642e9fd508ea8022">DEG2RAD</a>);</div><div class="line">P_init(6,6) = (sigma_gyr*<a class="code" href="_a_d_s_core_8h.html#af7e8592d0a634bd3642e9fd508ea8022">DEG2RAD</a>) * (sigma_gyr*<a class="code" href="_a_d_s_core_8h.html#af7e8592d0a634bd3642e9fd508ea8022">DEG2RAD</a>);</div><div class="line">P_init(7,7) = (sigma_gyr*<a class="code" href="_a_d_s_core_8h.html#af7e8592d0a634bd3642e9fd508ea8022">DEG2RAD</a>) * (sigma_gyr*<a class="code" href="_a_d_s_core_8h.html#af7e8592d0a634bd3642e9fd508ea8022">DEG2RAD</a>);</div><div class="line"></div><div class="line"><span class="comment">// Kalman process noice matrix set up</span></div><div class="line">Kalman_Q(1,1) *= 1e-4 * dt * dt * dt / (12 * I_sat(1,1) * I_sat(1,1));</div><div class="line">Kalman_Q(2,2) *= 1e-4 * dt * dt * dt / (12 * I_sat(2,2) * I_sat(2,2));</div><div class="line">Kalman_Q(3,3) *= 1e-4 * dt * dt * dt / (12 * I_sat(3,3) * I_sat(3,3));</div><div class="line">Kalman_Q(4,4) *= 1e-4 * dt * dt * dt / 12;</div><div class="line">Kalman_Q(4,4) *=  (q_init(1)*I_sat(1,1))*(q_init(1)*I_sat(1,1))</div><div class="line">                + (q_init(2)*I_sat(2,2))*(q_init(2)*I_sat(2,2))</div><div class="line">                + (q_init(3)*I_sat(3,3))*(q_init(3)*I_sat(3,3));</div><div class="line">Kalman_Q(5,5) *= 1e-4 * dt * dt * dt / (     I_sat(1,1) * I_sat(1,1));</div><div class="line">Kalman_Q(6,6) *= 1e-4 * dt * dt * dt / (     I_sat(2,2) * I_sat(2,2));    </div><div class="line">Kalman_Q(7,7) *= 1e-4 * dt * dt * dt / (     I_sat(3,3) * I_sat(3,3));</div><div class="line"></div><div class="line"><span class="comment">// Kalman measurement noise matrix set up</span></div><div class="line"><span class="keywordtype">float</span> sigma_r[7] = {sigma_eta, sigma_epsilon, sigma_epsilon, sigma_epsilon, sigma_gyr, sigma_gyr, sigma_gyr};</div><div class="line"><span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; 7; i++){ Kalman_R(i+1,i+1) *= sigma_r[i]*sigma_r[i];}</div><div class="line"></div><div class="line"><span class="comment">// Initial quaternion set up</span></div><div class="line">q_init(2) = 1;</div><div class="line"></div><div class="line"><a class="code" href="class_filters_1_1_kalman_filter.html">Filters::KalmanFilter</a> kalman(I_sat, <a class="code" href="class_matrix.html#aa7bf588d788d601548a34030e59152b4">Matrix::zeros</a>(3,3), P_init, Kalman_Q, Kalman_R, q_init, <a class="code" href="class_matrix.html#aa7bf588d788d601548a34030e59152b4">Matrix::zeros</a>(3,1));</div><div class="line"></div><div class="line"><span class="keywordflow">while</span>(1){</div><div class="line">     q = kalman.filter(q, gyr_b, dt, <a class="code" href="class_matrix.html#aa7bf588d788d601548a34030e59152b4">Matrix::zeros</a>(3,1), <a class="code" href="class_matrix.html#aa7bf588d788d601548a34030e59152b4">Matrix::zeros</a>(3,1), <a class="code" href="class_matrix.html#aa7bf588d788d601548a34030e59152b4">Matrix::zeros</a>(3,1));</div><div class="line">     wait_ms(dt);</div><div class="line">}</div></div><!-- fragment --><h1>Dependencies</h1>
<p>This library depends on the "Matrix" library that can be found here: <a href="https://github.com/RemyChatel/">https://github.com/RemyChatel/</a></p>
<p>In turn this library relies on &lt;std::cmath&gt; and &lt;std::vector&gt;</p>
<dl class="section attention"><dt>Attention</dt><dd>This library uses float only (NOT double) and therefore expect 6 to 7 significant figures</dd></dl>
<h1>References</h1>
<ul>
<li>"Kalman Filtering and the Attitude Determination and Control Task", by Hale, Vergez, Meerman and Hashida</li>
<li>"Spacecraft Dynamic and Control: An introduction", by A. de Ruiter, C. Damaren and J Forbes,</li>
<li>"Fundamentals of Astrodynamics and Applications", by D. Vallado,</li>
</ul>
<h1>License</h1>
<p><b>(C) Copyright 2019 Remy CHATEL</b></p>
<p>Licensed Under GPL v3.0 License <a href="http://www.gnu.org/licenses/gpl-3.0.html">http://www.gnu.org/licenses/gpl-3.0.html</a></p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
